include: kde-desktop-pkgs.yaml
ref: fedora/33/${basearch}/kinoite
rojig:
  name: fedora-kinoite
  summary: "Fedora Kinoite (KDE) base image"
  license: MIT
packages:
  # Wayland support
  - kwayland-integration
  - kwin-wayland
  - plasma-workspace-wayland
  - xorg-x11-server-Xwayland
  # Portals for Flatpak
  - xdg-desktop-portal-kde
  # - akmod-nvidia
  # - xorg-x11-drv-nvidia
  - google-chrome-stable
  - teams
  - code  

repos:
  - fedora
  - fedora-updates
  - custom
  # - rpmfusion-free
  # - rpmfusion-nonfree
  # - rpmfusion-free-updates
  # - rpmfusion-nonfree-updates


postprocess:
  - |
    #!/usr/bin/bash
    set -xeuo pipefail
    # Do a dance to enable initial setup.  The default of requiring a file to
    # exist in /var conflicts with the libostree "/var starts empty" model, so
    # invert it.
    echo '[daemon]' >> /etc/gdm/custom.conf
    echo 'InitialSetupEnable=true' >> /etc/gdm/custom.conf
    # (See the 20userlogin overlay for more)
    # And disable systemd's builtin one
    rm -vf /usr/lib/systemd/system/systemd-firstboot.service /usr/bin/systemd-firstboot \
           /usr/lib/systemd/*.target.wants/systemd-firstboot.service
  - |
    #!/usr/bin/bash
    # https://github.com/containers/toolbox/pull/440
    rm -vf /etc/profile.d/toolbox.sh